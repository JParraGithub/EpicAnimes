{% load static %}
<header class="navbar glass">
  <a class="brand" href="{% url 'index' %}">
    <span class="logo">Epic<span>Animes</span></span>
  </a>
  <button class="nav-toggle" type="button" aria-label="Abrir menú">
    <i class="fa fa-bars"></i>
  </button>
  <div class="nav-group" id="navGroup">
    <nav class="nav-links" aria-label="Secciones principales">
      <a href="{% if nav_page == 'index' %}#inicio{% else %}{% url 'index' %}#inicio{% endif %}" data-nav-target="inicio">Inicio</a>
      <a href="{% if nav_page == 'index' %}#caracteristicas{% else %}{% url 'index' %}#caracteristicas{% endif %}" data-nav-target="caracteristicas">Características</a>
      <a href="{% if nav_page == 'index' %}#catalogo{% else %}{% url 'index' %}#catalogo{% endif %}" data-nav-target="catalogo">Catálogo</a>
      <a href="{% if nav_page == 'index' %}#kpi{% else %}{% url 'index' %}#kpi{% endif %}" data-nav-target="kpi">Indicadores</a>
      <a href="{% if nav_page == 'index' %}#comunidad{% else %}{% url 'index' %}#comunidad{% endif %}" data-nav-target="comunidad">Comunidad</a>
      <a href="{% if nav_page == 'index' %}#contacto{% else %}{% url 'index' %}#contacto{% endif %}" data-nav-target="contacto">Contacto</a>
      <a href="{% url 'sobre_nosotros' %}" class="{% if nav_page == 'sobre_nosotros' %}active{% endif %}">Nosotros</a>
      <a href="{% url 'terminos' %}" class="{% if nav_page == 'terminos' %}active{% endif %}">Términos</a>
    </nav>
    <div class="nav-actions">
      <a class="cart-pill" href="{% url 'carrito' %}" aria-label="Ir al carrito">
        <i class="fa fa-shopping-cart"></i>
        <span class="cart-count">{{ cart_count|default:0 }}</span>
      </a>
      {% if request.user.is_authenticated %}
        <div class="user-pill user-pill--dropdown">
          <button type="button" class="user-pill__toggle" aria-haspopup="true" aria-expanded="false">
            {% with request.user.get_full_name|default:request.user.username as display_name %}
              {% if perfil_cliente and perfil_cliente.foto %}
                <img class="user-pill__avatar" src="{{ perfil_cliente.foto.url }}" alt="Foto de {{ display_name }}">
              {% else %}
                <span class="user-pill__avatar-placeholder">{{ request.user.username|slice:":1"|upper }}</span>
              {% endif %}
              <span>{{ display_name }}</span>
            {% endwith %}
            <i class="fa fa-chevron-down"></i>
          </button>
          <div class="user-menu">
            <a href="{% url 'perfil_usuario' %}">Ir a cuenta</a>
            <a href="{% url 'editar_perfil' %}">Editar perfil</a>
            <a href="{% url 'historial_pedidos' %}">Historial de compras</a>
            {% if rol_usuario == "administrador" %}
              <a href="{% url 'dashboard_administrador' %}">Panel admin</a>
            {% elif rol_usuario == "vendedor" %}
              <a href="{% url 'dashboard_vendedor' %}">Panel vendedor</a>
            {% endif %}
            {% if rol_usuario == "comprador" %}
              <a href="{% url 'carrito' %}">Ver carrito</a>
            {% endif %}
            <form method="post" action="{% url 'logout' %}">
              {% csrf_token %}
              <button type="submit">Salir</button>
            </form>
          </div>
        </div>
      {% else %}
        {% if not hide_login_cta %}
          <a class="btn btn--primary small" href="{% url 'login' %}">
            <i class="fa fa-right-to-bracket"></i> Ingresar
          </a>
        {% endif %}
      {% endif %}
    </div>
  </div>
</header>

{% include 'includes/page_loader.html' %}
